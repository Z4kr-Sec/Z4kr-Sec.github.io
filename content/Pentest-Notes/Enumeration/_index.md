---
title: "Nmap Enumeration."
date: 2025-06-02T15:15:03-04:00
draft: false
toc: true
# Display the last modification date
displayUpdatedDate: true
width: wide
layout: list
weight: 3
---

![Nmap Logo](/assets/images/Pentest-Notes/Nmap-logo.jpg)

Every successful penetration, every robust defense, begins with ***information***. The digital realm, like the physical world, demands thorough reconnaissance to uncover its secrets and vulnerabilities. For years, one name has consistently stood out as one of the best network discovery tools: [Nmap](https://nmap.org/). More than just a simple scanner, Nmap is a sophisticated tool that helps you discover a network's live hosts, services, operating systems, and potential security weaknesses.* 

Here you will find some information that I find useful at the time when I am performing a pentest.
## Scan OPEN ports on Scope

This command will run the scan for the open ports against all the specified targets in *"scope."* 

```bash
 sudo nmap --open -oA nmap_scope_open -iL scope                               
```
- **-oA** --> Output in all formats.
- **-iL** --> input from List of Hosts (scope)

## Scanning the entire TCP range

This command will start a full TCP SYN scan against the specified host. Assuming the target is online, the scanner will focus only on the ports marked as open.

```bash
sudo nmap -p- --open -sS -vvv -n -Pn 10.10.11.13 -oN nmap/OP_ports
```
- **-sS** --> TCP SYN Connection, it doesn't finish the Three-way handshake.
- **-n** --> Dont do DNS resolution.
- **-Pn** --> Treat all hosts online - skip host discovery.
- **vvv** --> verbose.
- **-oN** --> normal can output 
- **-p-** --> Scan all ports 


## Scan specific ports.

This scan will attempt to determine the version on the services running in the specified ports (-p)

```bash
sudo nmap -sS -sV -sC -p{PORTS} -Pn -n -vvv {IP} -oA nmap/allPorts
```

- **-sV** --> On the open ports open determine service/version info
- **-sC** --> script scan (running default)

## Aggressive Scan 
this will make much more noise than -sV -sS -sC
```bash
sudo nmap --open -p- -A -oA open_Agres_scan -iL scope
```
## Static Nmap - Pivot machine  
### Scan ports with binary nmap

There are cases in which the tester/attacker has a foothold on an internal machine (pivot machine) but has no nmap or similar tools to perform the scan.

One solution for this is to use [static binaries](https://github.com/andrew-d/static-binaries/tree/master), so they don't need any extra dependencies/packages to run.

Scanning on pivot machines with binaries can be slower or it can "break" your shell session. I usually scan just for open ports.

* Get nmap binary [here.](https://github.com/andrew-d/static-binaries/blob/master/binaries/linux/x86_64/nmap)

```bash
./nmap -Pn -p- 172.16.139.35
```


## Scan UDP ports
This will scan the most popular UDP ports 

```bash
sudo nmap  -sU -n -Pn -vvvv 10.10.11.48 -oA UDPscan
```


## Others

### Updating Nmap DB
```bash
sudo nmap --script-updatedb
```

- Location where the nmap scripts should be located --> ***/usr/share/nmap/scripts***


### Scanning multiple IP's

This is a simple way to scan for machines on the networks (if the firewall *allow* it )
```sh 
sudo nmap 10.129.2.0/24 -sn -oA tnet | grep for | cut -d" " -f5

# Scan Small (more specific) part of the network 
sudo nmap -sn -oA tnet 10.129.2.18 10.129.2.19 10.129.2.20| grep for | cut -d" " -f5

# scan range of octecs
 sudo nmap -sn -oA tnet 10.129.2.18-20| grep for | cut -d" " -f5
# ping scan
sudo nmap 10.129.2.18 -sn -oA host -PE --reason
```
***optionals***
* -PE --> ping scan






## Cheat Codes
This is a great source that contains queries that make search faster on Nmap outputs.
- https://github.com/leonjza/awesome-nmap-grep?tab=readme-ov-file#banner-grab


### Service Name

```bash
NMAP_FILE=allPorts.gnmap

egrep -v "^#|Status: Up" $NMAP_FILE | cut -d ' ' -f4- | tr ',' '\n' | \
sed -e 's/^[ \t]*//' | awk -F '/' '{print $5}' | grep -v "^$" | sort | uniq -c \
| sort -k 1 -nr
```

### Service Identifier

```bash
NMAP_FILE=allPorts.gnmap

egrep -v "^#|Status: Up" $NMAP_FILE | cut -d ' ' -f4- | tr ',' '\n' | \
sed -e 's/^[ \t]*//' | awk -F '/' '{print $7}' | grep -v "^$" | sort | uniq -c \
| sort -k 1 -nr
```

### Host and Opent ports 

```bash
NMAP_FILE=allPorts.grep

egrep -v "^#|Status: Up" $NMAP_FILE | cut -d' ' -f2,4- | \
sed -n -e 's/Ignored.*//p' | \
awk '{print "Host: " $1 " Ports: " NF-1; $1=""; for(i=2; i<=NF; i++) { a=a" "$i; }; split(a,s,","); for(e in s) { split(s[e],v,"/"); printf "%-8s %s/%-7s %s\n" , v[2], v[3], v[1], v[5]}; a="" }'
```


## Collaboration & Correction

I'm always open to **collaboration** and giving **proper attribution** to external work. If you notice any inaccuracies or have suggestions for improvement, please don't hesitate to contact me so I can address them. Your feedback helps make this resource better for everyone.